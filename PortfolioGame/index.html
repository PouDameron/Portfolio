<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Portfolio Game</title>
  <script src="https://cdn.jsdelivr.net/npm/phaser@3.70.0/dist/phaser.js"></script>
  <style>
    body {
      margin: 0;
      overflow: hidden;
    }
    canvas {
      display: block;
    }
  </style>
</head>
<body>
  <div id="game"></div>

  <script>
    const LEVEL_W = 4000;
    const LEVEL_H = 600;

    class PlayScene extends Phaser.Scene {
      constructor() {
        super('PlayScene');
      }

      preload() {
        this.load.spritesheet('player', 'assets/player.png', {
          frameWidth: 32,
          frameHeight: 48
        });

        this.load.image('player_torch', 'assets/player_torch.png');

        this.load.spritesheet('ground', 'assets/ground.png', {
          frameWidth: 32,
          frameHeight: 32
        });

        this.load.image('platform', 'assets/platform.png');
        this.load.image('sign', 'assets/sign.png');
      }

      create() {
        // Suelo: grupo estático de tiles
        this.groundGroup = this.physics.add.staticGroup();

        for (let x = 0; x < LEVEL_W; x += 32) {
          const tile = this.groundGroup.create(x, this.scale.height - 16, 'ground', 0).setOrigin(0, 0.5);
          tile.refreshBody();
        }

        // Plataformas
        const plats = this.physics.add.staticGroup();
        plats.create(1300, 380, 'platform').refreshBody();  // Horror zone
        plats.create(2300, 420, 'platform').refreshBody();  // Arcade zone
        plats.create(3200, 360, 'platform').refreshBody();  // Platformer zone

        // Player
        this.player = this.physics.add.sprite(100, 300, 'player');
        this.player.setCollideWorldBounds(true);

        // Colliders
        this.physics.add.collider(this.player, this.groundGroup);
        this.physics.add.collider(this.player, plats);

        // Cámaras
        this.cameras.main.setBounds(0, 0, LEVEL_W, LEVEL_H);
        this.physics.world.setBounds(0, 0, LEVEL_W, LEVEL_H);
        this.cameras.main.startFollow(this.player, true, 0.08, 0.08);

        // Controles
        this.cursors = this.input.keyboard.createCursorKeys();

        // Carteles
        this.add.image(1300, 280, 'sign').setScale(0.5);
        this.add.image(2300, 320, 'sign').setScale(0.5);
        this.add.image(3200, 220, 'sign').setScale(0.5);
      }

      update() {
        const speed = 200;

        if (this.cursors.left.isDown) {
          this.player.setVelocityX(-speed);
          this.player.flipX = true;
        } else if (this.cursors.right.isDown) {
          this.player.setVelocityX(speed);
          this.player.flipX = false;
        } else {
          this.player.setVelocityX(0);
        }

        if (this.cursors.up.isDown && this.player.body.touching.down) {
          this.player.setVelocityY(-500);
        }

        // Cambio de sprite en la zona de "terror"
        if (this.player.x > 1200 && this.player.x < 1600) {
          this.player.setTexture('player_torch');
        } else {
          this.player.setTexture('player');
        }
      }
    }

    const config = {
      type: Phaser.AUTO,
      width: window.innerWidth,
      height: window.innerHeight,
      parent: 'game',
      physics: {
        default: 'arcade',
        arcade: { gravity: { y: 1000 }, debug: false }
      },
      scene: [PlayScene]
    };

    const game = new Phaser.Game(config);

    // Redimensionar cuando cambie el tamaño de la ventana
    window.addEventListener('resize', () => {
      game.scale.resize(window.innerWidth, window.innerHeight);
    });
  </script>
</body>
</html>
